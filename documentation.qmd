# Documentation {#sec-documentation}

Documentation is the process of recording all aspects of project design; sampling; lab analyses; data cleaning; data analyses; data quality control and assurance procedures; and development of decision-support tools. Seem familiar? All of these aspects are also part of our data life cycle. We document our data throughout the life cycle to:

-   standardize our procedures
-   enable reproducibility
-   establish credibility
-   ensure others (including our future selves) use and interpret data correctly
-   provide searchability

**All documentation (including this document) should be updated (and versioned) as procedures change and lessons are learned.**

Samples collected by WSDA for the SOS should follow the procedures and standards described in the below documentation.

External data must have at least the documentation outlined in @sec-external-data to be integrated into the SOS dataset.

## Project-level

Project-level documentation includes all descriptive information about the SOS dataset, as well as planning decisions and process documentation. Documentation includes quality assurance project plans, standard operating procedures, and other high-level documents (i.e., request for proposals, applications, meeting agendas/notes, etc.).

### Quality assurance project plan (QAPP)

The QAPP is the highest level of project documentation and covers everything from the project description; personnel roles and responsibilities; project timelines; data and measurement quality objectives; study design; and overviews of field, laboratory, and quality control.

Ours can be found in [Y:/NRAS/soil-health-initiative/state-of-the-soils/qapp](Y:/NRAS/soil-health-initiative/state-of-the-soils/qapp), though it needs to be updated.

### Standard operating procedures (SOP)

SOPs provide detailed instructions for field, lab, or data processing procedures and decision making processes.

Ours can be found in [Y:/NRAS/soil-health-initiative/state-of-the-soils/sop](Y:/NRAS/soil-health-initiative/state-of-the-soils/sop).

#### SOS sampling

The purpose of this [SOP](Y:/NRAS/soil-health-initiative/state-of-the-soils/sop/sampling) is to detail the procedures for a typical site visit in which soil samples are collected for physical, chemical, and biological soil health indicator analyses. Procedures include equipment preparation prior to sampling; best practices for filling out field forms; the selection of sampling locations; sampling protocols; sample handling and storage; and submitting samples to the lab. Following this SOP ensures data quality by creating audit trails and reminders to check that data are present, complete, and accurate. Additionally, this SOP will be used to maintain consistent sample collection procedures throughout the state for WSDA employees and partners.

#### Quality control / quality assurance (QA/QC)

This [SOP](Y:/NRAS/soil-health-initiative/state-of-the-soils/sop/qc) outlines the process for screening sample metadata and lab results for completeness, consistency, and quality. Procedures involve subject matter expertise, investigation, communication with sampling teams and labs, algorithmic quality control, and tagging sample results with quality codes (listed in the below table). Data are then integrated into the statewide database according to a SOP not yet authored.

+-------------+---------------+----------------------------------------+---------------------------+
| **Code**    | **Tag**       | **Description**                        | **Inclusion in analyses** |
+=============+===============+========================================+===========================+
| **0**       | Excellent     | Met lab's and WSDA's QC criteria       | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+
| **100**     | Estimate      | Interpolated missing value             | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+
| **110**     | Derived       | Derived from an estimated value        | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+
| **120**     | Suspect       | Z-score is â‰¥ \|3\|                     | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+
| **130**     | Calculated ND | Calculated value using at least one ND | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+
| **140**     | Non-detect    | Below the method detection limit       | No                        |
+-------------+---------------+----------------------------------------+---------------------------+
| **160**     | Poor          | Did not meet lab's QC criteria         | No                        |
+-------------+---------------+----------------------------------------+---------------------------+
| **180**     | Outlier       | Outlier, designated by soil scientist  | No                        |
+-------------+---------------+----------------------------------------+---------------------------+
| **200**     | Unknown       | External dataset                       | Yes                       |
+-------------+---------------+----------------------------------------+---------------------------+

: {.striped}

#### SOPs we don't have (yet)

-   assigning producer, field, and sample IDs
-   data cleaning
-   data import into the database
-   data storage
-   external data integration

## Dataset-level

Dataset-level documentation applies to lab results, sample locations, grower information, and management data. We use readmes and changelogs to document what each dataset contains, how they are related, potential issues to be aware of, and any alterations made to the data.

### Readme {#sec-readme}

`readme` files are plain text documents that contain information about the files in a folder, explanation of versioning, and instructions/metadata for data packages. These files are saved as `.txt`, instead of MS Word documents that take longer to open and can only be opened on computers with Microsoft installed.

#### Describe contents of folder

For example, the `_complete-dataset` folder contains a [readme.txt](Y:/NRAS/soil-health-initiative/state-of-the-soils/_complete-dataset/readme.txt) that describes each files' structure, contents, and other pertinent information, such as the data source.

::: {.content-visible when-format="html"}
<details>

<summary>View the example</summary>

```         
2020-2023_lab-results_wide has one sample per row with each measurement as a separate column.

2020-2023_lab-results_long has one result per row with columns for sample identification, measurement name, result value, quality code, and lab.
This spreadsheet also contains a second tab that describes the quality codes.

2020-2023_sample-locations has the coordinates, PRISM mean annual precipitation and mean annual temperature (800 m resolution, 30-year normals, 1991-2020), and SHI strata.

data-dictionary lists each variable with its short name (variable name without units), description, indicator type (chemical, physical, biological), unit (if applicable), label, and data type.
This spreadsheet also contains a second tab that describes the variables in the sampleLocations spreadsheet.

scbg_producer-id_recode lists all SCBG fields with original SCBG assigned producer ID and new WSDA producer ID

all-farm-info lists all participating farm names, producer names, producer IDs, field names, field IDs, and county

example-data.csv contains 100 random samples that have been anonymized with fake sampleIDs, county, farm, producer, and field names. WSU SCBG samples are excluded, as are the 0-6in to 6-12in WSDA samples.
```

</details>
:::

#### Explain versions

Another example is the [readme.txt](Y:/NRAS/soil-health-initiative/state-of-the-soils/2023_sampling/lab-data/raw/readme.txt) in the `2023_sampling` \> `lab-data` \> `raw` folder, which explains why there are two different versions of the lab results and where to find additional information.

::: {.content-visible when-format="html"}
<details>

<summary>View the example</summary>

```         
2023-08-21
2023_wsda-soil-health_v1.xlsx has errors. See email for details.
'          'v2.xlsx still has some errors, that are cleaned up in the R scripts.
```

</details>
:::

#### Provide instructions

An example of a [readme.txt](https://app.box.com/s/axozzclt3nus5mzhmvspo2dtxrbfbpbj) that provides instructions on how to use the folder contents can be found in the [ArcGIS soil sample points box.com folder](https://app.box.com/s/4d6xg8q5dr1cjjoxver0g3h35d3s3bao). When this folder is shared with our partners, the readme helps them orient to the contents of the folder and modify the files as needed for their own adaptation.

::: {.content-visible when-format="html"}
<details>

<summary>View the example</summary>

```         
Template for Soil Sample Points ArcGIS

2023-06-01

Jadey Ryan | Washington State Department of Agriculture (WSDA)
jryan@agr.wa.gov

Purpose:
To provide a template for ESRI ArcGIS data entry and management for soil sampling projects.

Folder contents:
- readme.txt describes the folder contents and provides general instructions.
- template-soil-sample-points.aprx is an ArcGIS Project File should allow you to open the project in ArcGIS Pro.
- template-soil-sample-points.gdb is a file geodatabase, which you can open in ArcGIS Pro or ArcGIS Online.
- crop-domain.csv provides WSDA approved crop types to use in ArcGIS 'Table to Domain' geoprocessing tool. We highly recommend using attribute domains, which are rules to enforce data integrity by limiting the field type and choices of an attribute field.
- 923-nras-soil-health-sop-web.pdf is WSDA's Standard Operating Procedure for soil sampling. The appendices contain instructions for the GIS workflow of soil sampling.
- /screenshots/feature-layer-offline-editing.png shows the checkboxes required for editing.
- /screenshots/configure-forms.png shows where to click within a Web Map to open the Field Maps form editor.
- /screenshots/table-to-domain.png is an example of how to use the 'Table to Domain' geoprocessing tool with the crop_domain.csv.
- /screenshots/field-maps-form_*.png are examples of the Field Maps form structure, which can be created in ArcGIS Online.
- washi_soil-series-rest-service is an internet shortcut to the URL for the Washington clipped soil series, originating from NRCS gSSURGO. When compositing multiple samples together from one field, we recommend keeping all sample points within one soil series to reduce variability in the composite samples.
- The other folders (Index, GpMessages, ImportLog, .backups) are part of the ArcGIS Pro project and can be ignored.

Instructions:
1. Open template-soil-sample-points.aprx.
2. Update attribute fields and domains to work with your project.
3. Update symbology, labels, visibility scale, popups, etc. The symbology of the sample points currently defaults to red when the 'Show/Hide Field Form' attribute is still 'Hide' or 'NULL'. When the sampler collects the sample and changes this attribute to 'Show', the point will turn yellow to indicate the sample has been collected.
4. Share as Feature Layer and create a Web Map to allow others access to this map.
5. Open the map in ArcGIS Online and click on 'Forms' in the right toolbar to configure your Field Maps form.
6. Use the /screenshots/field-maps-form_*.pngs as a guide, but adapt the field form structure to suit your project.

Offline Areas:
- If you anticipate needing to sample without cellular service or wifi access: 1) Open the hosted feature layer, 2) Click 'Settings' 3) Confirm 'Enable Sync' is turned on.
- If you need the Soil Series layer, you will need to configure two separate Web Maps: one with and one without. This is because the washi_soil-series-rest-service is not allowed in Web Maps with 'Enable Sync' turned on. 
- Alternatively, you can create your own Soil Series layer and host it as a feature layer in your own organization.

Resources:
- WSDA Soil Health YouTube channel: https://www.youtube.com/playlist?list=PL0pB20prk7Ni1daEYiEEXSWy8CfwO34FC
- WSDA WaSHI_SoilSeries MapServer: https://fortress.wa.gov/agr/gis/wsdagis/rest/services/NRAS/WaSHI_SoilSeries/MapServer
- Introduction to attribute domains: https://pro.arcgis.com/en/pro-app/latest/help/data/geodatabases/overview/an-overview-of-attribute-domains.htm
- Introducing smart forms in ArcGIS Field Maps: https://www.esri.com/arcgis-blog/products/field-maps/field-mobility/introducing-arcgis-smart-forms/
```

</details>
:::

### Changelog

Changelogs are also simple and concise plain text documents saved in a folder alongside data files to document any changes to the dataset.

At the bare minimum, the `changelog.txt` should contain:

-   date of modification
-   initials of who made the changes
-   description of the changes

::: {.content-visible when-format="html"}
An example [changelog.txt](Y:/NRAS/soil-health-initiative/state-of-the-soils/_complete-dataset/changelog.txt) can be found in the `_complete-dataset` folder.

<details>

<summary>View the example</summary>

```         
Contents of changelog.txt in _complete-dataset folder:

2022-12-15 JR standardized texture classes (title case, no extra white space) and converted texture, county, and crop to factor types.
2023-01-03 JR corrected error in 2022 WSDA bulk density measurements in 2022-11-01_soiltestData_manualCleanup.xlsx.
2023-03-02 JR recoded SCBG producer IDs to match WSDA format and cleaned up farm/producer names and IDs. See new scbg_producerId_recode.csv for list.
2023-03-07 JR corrected Okanogan producer and field names (Devany, Townsend).
2023-03-21 JR corrected cropType "Fallow, Idle" to "Fallow" and 2021 SCBG "Pea" samples to "Pea, Dry", updated Crop Group column. Updated results and sample locations spreadsheets.
2023-07-13 JR added labID to labResults datasets and updated dataDictionary accordingly. 
2023-08-21 JR added 2023 data and updated dataDictionary sample_locations tab.
2023-08-27 JR corrected SCBG pulse samples crop from "Pea" to "Pea, Dry".
2023-08-30 JR added an anonymized dataset (100 samples from 2022-2023).
2023-09-05 JR added labID to 2023 results.
2023-09-06 JR added sampling organization column to make impact tracking easier. Fixed merge issue that was causing the loss of some producer IDs. Add "County" to relevant CD names.
2023-11-14 JR switched from .RData to .RDS file type so users can assign a new name when loading the data into R with `data_wide <- readRDS("2020-2023_labResults_wide.RDS")`.
2023-11-14 JR added sampling dates and depths to all 877 samples. See addSampleDepthsDates for R script. 
2023-12-08 JR corrected CropGroup from Fallow to Cereal Grain for samples with CropType of Fallow, Wheat in 2020-2023_sampleLocations.csv.
```

</details>
:::

## Variable-level

Variable-level documentation includes data dictionaries and codebooks, which are often talked about interchangeably. However, we'll refer to the **data dictionary** as a tabular collection of names, definitions, and attributes about the variables in a dataset. Data dictionaries are ideally created in the planning phase of the project before data are collected. In contrast, **codebooks** provide descriptive, variable-level information and univariate summary statistics to allow users to understand the contents of a dataset without opening it. The codebook is created or updated after data are collected, cleaned, and validated.

### Data dictionary

In a data dictionary, each row is a different variable, while each column is a different attribute of that variable. With a data dictionary, any user should be able to properly interpret each variable in our data.

Our [data-dictionary.xlsx](Y:/NRAS/soil-health-initiative/state-of-the-soils/_complete-cataset/data-dictionary.xlsx) in the [\_complete-dataset folder](Y:/NRAS/soil-health-initiative/state-of-the-soils/_complete-dataset) contains two tabs (`lab-results` and `sample-locations`) that describe the attributes of each variable.

**TODO**: update variable names in R scripts, data dictionary, and Soiltest template.

::: {.content-visible when-format="html"}
<details>

<summary>View the `sample-locations` dictionary</summary>

+-------------+-------------------------------------------------+-----------------+-----------+
| variable    | description                                     | unit            | dataType  |
+=============+=================================================+=================+===========+
| year        | Year the sample was collected                   |                 | Numeric   |
+-------------+-------------------------------------------------+-----------------+-----------+
| county      | County of the sampled field                     |                 | Character |
+-------------+-------------------------------------------------+-----------------+-----------+
| sampleId    | Sample identification code                      |                 | Character |
+-------------+-------------------------------------------------+-----------------+-----------+
| cropGroup   | Crop group of the sampled field                 |                 | Character |
+-------------+-------------------------------------------------+-----------------+-----------+
| cropType    | Crop type of the sampled field                  |                 | Character |
+-------------+-------------------------------------------------+-----------------+-----------+
| stratum     | Soil Health Institute stratum                   |                 | Character |
+-------------+-------------------------------------------------+-----------------+-----------+
| MAP_mm.year | OSU PRISM mean annual precipitation             | mm/year         | Numeric   |
|             |                                                 |                 |           |
|             | 30-year normals (1991-2020) at 800 m resolution |                 |           |
+-------------+-------------------------------------------------+-----------------+-----------+
| MAT_c       | OSU PRISM mean annual temperature               | degrees C       | Numeric   |
|             |                                                 |                 |           |
|             | 30-year normals (1991-2020) at 800 m resolution |                 |           |
+-------------+-------------------------------------------------+-----------------+-----------+
| longitude   | Longitude of sample point, WGS84                | decimal degrees | Numeric   |
+-------------+-------------------------------------------------+-----------------+-----------+
| latitude    | Latitude of sample point, WGS84                 | decimal degrees | Numeric   |
+-------------+-------------------------------------------------+-----------------+-----------+

: {.striped}

</details>
:::

### Codebook

Codebooks provide more information (i.e., existing values/ranges and summary statistics) than the data dictionary and can be used to understand a very high-level summary of the processed data. There are many R packages that generate codebooks; however, we have not implemented this type of documentation for our project yet.

Crystal Lewis gave the lightning talk [*A Comparison of Packages to Generate Codebooks*](https://github.com/Cghlewis/codebook-pkg-comparison). Once, our data live in a database, I'd like to generate codebooks.

## External data {#sec-external-data}

External data refers to any data not directly collected by WSDA or trained partners (e.g., WSU or conservation districts) that follow our SOPs. These can include other studies pre-dating WaSHI, special soil health surveys, or publicly available datasets.

The Data Scientist and Senior Soil Scientist will decide whether to integrate an external dataset case by case by considering the following questions:

-   How does the study design fit into SOS goals?
-   Who collected the soil samples?
-   What field procedures were used and how were they documented?
-   Who analyzed the soil samples? With which methods and QA/QC procedures?
-   Which pieces of metadata and management data accompany the lab results?
    -   Farm, producer and field info[^documentation-1]
    -   Sampling date
    -   Sampling depth
    -   Latitude and longitude
    -   Production system (current crop, crop rotation, etc.)
    -   Tillage, livestock grazing, irrigation, soil fertility and amendments, conservation practices, etc.
-   Is there a data dictionary or codebook to describe the variables and measurements, units, missing values, etc.?

[^documentation-1]: Enough farm, producer and field info to distinguish unique farmers and fields for assigning unique IDs. This info doesn't need to be personally identifiable information.

Generally, the external data should **1)** be well documented, **2)** be collected and analyzed by well-trained scientists and labs; and **3)** have adequate accompanying metadata and management data to facilitate interpretation of the results.

Some publicly available datasets to consider are listed in [Y:/NRAS/soil-health-initiative/state-of-the-soils/data-sources](Y:/NRAS/soil-health-initiative/state-of-the-soils/data-sources).
