<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Management Plan - 9&nbsp; Code style guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./share.html" rel="prev">
<link href="./images/washi-circle.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./code-guide.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code style guide</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/washi-logo.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Management Plan</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/WA-Department-of-Agriculture/washi-dmp" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is data management?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formats-standards.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Formats &amp; standards</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./naming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Naming conventions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Organization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./storage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Storage</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./documentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Documentation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data flow</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./share.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data sharing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code-guide.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code style guide</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#projects" id="toc-projects" class="nav-link active" data-scroll-target="#projects"><span class="header-section-number">9.1</span> Projects</a>
  <ul class="collapse">
  <li><a href="#sec-project-folder-structure" id="toc-sec-project-folder-structure" class="nav-link" data-scroll-target="#sec-project-folder-structure">Project folder structure</a></li>
  <li><a href="#absolute-vs-relative-paths" id="toc-absolute-vs-relative-paths" class="nav-link" data-scroll-target="#absolute-vs-relative-paths">Absolute vs relative paths</a></li>
  <li><a href="#here-package" id="toc-here-package" class="nav-link" data-scroll-target="#here-package">{here} package</a></li>
  </ul></li>
  <li><a href="#naming-conventions" id="toc-naming-conventions" class="nav-link" data-scroll-target="#naming-conventions"><span class="header-section-number">9.2</span> Naming conventions</a>
  <ul class="collapse">
  <li><a href="#project-folder-.rproj-and-github-repository" id="toc-project-folder-.rproj-and-github-repository" class="nav-link" data-scroll-target="#project-folder-.rproj-and-github-repository">Project folder, .RProj and GitHub repository</a></li>
  <li><a href="#files" id="toc-files" class="nav-link" data-scroll-target="#files">Files</a></li>
  <li><a href="#variables-objects-and-functions" id="toc-variables-objects-and-functions" class="nav-link" data-scroll-target="#variables-objects-and-functions">Variables, objects, and functions</a></li>
  </ul></li>
  <li><a href="#r-scripts" id="toc-r-scripts" class="nav-link" data-scroll-target="#r-scripts"><span class="header-section-number">9.3</span> R scripts</a>
  <ul class="collapse">
  <li><a href="#header-template" id="toc-header-template" class="nav-link" data-scroll-target="#header-template">Header template</a></li>
  <li><a href="#section-template" id="toc-section-template" class="nav-link" data-scroll-target="#section-template">Section template</a></li>
  </ul></li>
  <li><a href="#code-styling" id="toc-code-styling" class="nav-link" data-scroll-target="#code-styling"><span class="header-section-number">9.4</span> Code styling</a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage">Usage</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/WA-Department-of-Agriculture/washi-dmp/blob/main/code-guide.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/WA-Department-of-Agriculture/washi-dmp/edit/main/code-guide.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-code-style-guide" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code style guide</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This style guide is an adaptation of the <a href="https://style.tidyverse.org/"><em>tidyverse style guide</em></a> and includes best practices from <a href="https://r4ds.hadley.nz/"><em>R for Data Science (2e)</em></a> (<em>R4DS</em>), <a href="https://datamgmtinedresearch.com/style.html"><em>Data Management in Large-Scale Education Research</em></a>, and other resources.</p>
<p><strong>All WaSHI staff who code in R should thoroughly read and consistently implement this style guide.</strong></p>
<p>Using consistent project structures, naming conventions, script structures, and code style will improve code readability, analysis reproducibility, and ease of collaboration.</p>
<blockquote class="blockquote">
<p>Good coding style is like correct punctuation: you can manage without it, butitsuremakesthingseasiertoread…</p>
<p>All style guides are fundamentally opinionated. Some decisions genuinely do make code easier to use (especially matching indenting to programming structure), but many decisions are arbitrary. The most important thing about a style guide is that it provides consistency, making code easier to write because you need to make fewer decisions.</p>
<p>- Hadley Wickham in the <a href="https://style.tidyverse.org/">tidyverse style guide</a></p>
</blockquote>
<section id="projects" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="projects"><span class="header-section-number">9.1</span> Projects</h2>
<p>All files associated with a given project (input data, R scripts, analytical results, figures, reports) should be kept together in one directory. RStudio has built-in support for this through <strong>projects</strong>. R projects bundle all the work in a portable, self-contained folder that can be moved around on your computer or on to other collaborators’ computers and still work.</p>
<p>Learn more about projects in the <a href="https://r4ds.hadley.nz/workflow-scripts.html#projects">Workflow: scripts and projects chapter of <em>R4DS</em></a>, in Jenny Bryan’s article <a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/"><em>Project-oriented workflow</em></a>, and Shannon Pileggi’s <a href="https://www.pipinghotdata.com/talks/2023-09-11-project-oriented-workflows/">workshop slides</a>.</p>
<p>To create a project in RStudio, click <code>File</code> &gt; <code>New Project</code>, then follow the steps in the below figure.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="https://r4ds.hadley.nz/diagrams/new-project.png" class="lightbox" title="Figure from Chapter 6 of R4DS" data-gallery="quarto-lightbox-gallery-1"><img src="https://r4ds.hadley.nz/diagrams/new-project.png" class="img-fluid figure-img" alt="Three screenshots of the New Project menu. In the first screenshot, the Create Project window is shown and New Directory is selected. In the second screenshot, the Project Type window is shown and Empty Project is selected. In the third screenshot, the Create New Project  window is shown and the directory name is given as r4ds and the project is being created as subdirectory of the Desktop. Figure from Chapter 6 of R4DS."></a></p>
<figcaption class="figure-caption">Figure from Chapter 6 of <em>R4DS</em></figcaption>
</figure>
</div>
<p>The project folder should be checked into GitHub for version control as discussed in <a href="storage.html#sec-version-control"><span>Section&nbsp;5.3</span></a>.</p>
<p>If not checked into GitHub, at bare minimum, the folder should be copied onto the shared drive.</p>
<section id="sec-project-folder-structure" class="level3">
<h3 class="anchored" data-anchor-id="sec-project-folder-structure">Project folder structure</h3>
<p>Having a consistent and logical folder structure will make it easier for you (especially future you) and collaborators to make sense of the files and work you’ve done. Well documented projects also make it easier to resume a project after some time away with minimal frustration of having to remember where everything is, what you did, and why you did it.</p>
<p>The below structure works most of the time and should be used as a starting point. However, different projects have different needs, so add and remove subfolders as needed.</p>
<ul>
<li><p><strong>root</strong>: top-level project folder containing the <code>.Rproj</code> file.</p></li>
<li><p><strong>data</strong>: contains raw and processed data files in subfolders. Raw data should be made <em>read-only</em> and not changed in any way. See <a href="storage.html#sec-raw-data"><span>Section&nbsp;5.2</span></a> for a reminder on how to make a file read-only.</p></li>
<li><p><strong>output</strong>: outputs from R scripts such as figures or tables.</p></li>
<li><p><strong>R</strong>: all R scripts containing data processing or function definitions.</p></li>
<li><p><strong>reports</strong>: Quarto or RMarkdown files are saved here, as well as the resulting reports.</p></li>
<li><p><strong>README</strong>: a markdown file (can be generated from Quarto or RMarkdown) to explain the project.</p></li>
</ul>
<details>
<summary>
See an example project folder structure
</summary>
<pre><code>├── project-demo.Rproj
├── data
│   ├── processed
│   │   └── data-clean.csv
│   └── raw
│       └── data-raw.xlsx
├── output
│   ├── fig-01.png
│   ├── fig-02.png
│   ├── tbl-01.png
│   └── tbl-02.png
├── R
│   ├── 01_import.R
│   ├── 02_tidy.R
│   ├── 03_transform.R
│   ├── 04_visualize.R
│   └── custom-functions.R
└── reports
│   ├── soil-health-report.pdf
│   └── soil-health-report.qmd
│   └── images
│       └── logo.png
├── README.md
└── README.qmd</code></pre>
</details>
<p>R packages may contain these additional subfolders and files:</p>
<ul>
<li><p><strong>inst</strong>: any arbitrary additional files to be included with package installation such as <code>CITATION</code>, fonts, and Quarto templates.</p></li>
<li><p><strong>man</strong>: all <code>.Rd</code> (“R documentation”) files for each function that are generated from <a href="https://roxygen2.r-lib.org/">{roxygen2}</a>.</p></li>
<li><p><strong>vignettes</strong>: long-form guides that go beyond function documentation and can be used as tutorials to demonstrate a workflow using the package to solve a particular problem.</p></li>
<li><p><strong>tests</strong>: all test files, usually using <a href="https://testthat.r-lib.org/">{testthat}</a>.</p></li>
<li><p><strong>pkgdown</strong> and <strong>docs</strong>: if using <a href="https://pkgdown.r-lib.org/">{pkgdown}</a> to build a website for the package, you may have a pkgdown folder containing the favicon and any additional css and a docs folder containing the website source files.</p></li>
<li><p><strong>DESCRIPTION</strong>: file containing metadata about the package (authors, current version, dependencies).</p></li>
<li><p><strong>LICENSE</strong>: file describing the package usage agreement.</p></li>
<li><p><strong>NAMESPACE</strong>: file generated by <a href="https://roxygen2.r-lib.org/">{roxygen2}</a> listing functions imported from other packages.</p></li>
<li><p><strong>NEWS.md</strong>: file documenting user-facing changes to a package.</p></li>
</ul>
<p>Learn more about other R package components in <a href="https://r-pkgs.org/"><em>R Packages (2e)</em></a>.</p>
</section>
<section id="absolute-vs-relative-paths" class="level3">
<h3 class="anchored" data-anchor-id="absolute-vs-relative-paths">Absolute vs relative paths</h3>
<p>Note: directories are synonymous with folders.</p>
<p>❌Absolute paths start with the root directory and provide the full path to a specific file or folder like <code>C:\\Users\\jryan\\Documents\\R\\projects\\project-demo\\data\\processed</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> You can run <code>getwd()</code> to find out where the current working directory is and <code>setwd()</code> to set a specific folder as your working directory. However, <strong>please don’t do use <code>setwd()</code></strong> because this absolute file path is going to break your code if you reorganize your folders and is not going to work on any collaborators’ computers as their directory configuration will be different.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/e684ee45-98fc-469e-997c-e2d68b0096cd_rw_1920.png?h=d754f634e6fc1e292430124fbe44dad7" class="lightbox" title="A cartoon of a cracked glass cube looking frustrated with casts on its arm and leg, with bandaids on it, containing “setwd”, looks on at a metal riveted cube labeled “R Proj” holding a skateboard looking sympathetic, and a smaller cube with a helmet on labeled “here” doing a trick on a skateboard. Artwork by @allison_horst." data-gallery="quarto-lightbox-gallery-2"><img src="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/e684ee45-98fc-469e-997c-e2d68b0096cd_rw_1920.png?h=d754f634e6fc1e292430124fbe44dad7" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">A cartoon of a cracked glass cube looking frustrated with casts on its arm and leg, with bandaids on it, containing “setwd”, looks on at a metal riveted cube labeled “R Proj” holding a skateboard looking sympathetic, and a smaller cube with a helmet on labeled “here” doing a trick on a skateboard. Artwork by <a href="https://twitter.com/allison_horst">@allison_horst</a>.</figcaption>
</figure>
</div>
<p>✅Instead, always use relative paths in your scripts. Relative paths are <em>relative</em> to the working directory (i.e.&nbsp;the project’s home) like <code>data/processed/data-clean.csv</code>. When working in a RStudio project, the default working directory is always the <strong>root</strong> project directory (where the <code>.Rproj</code> file is).</p>
<p>For example, say <code>01_import.R</code> contains the code <code>read.csv("data/processed/data-clean.csv")</code>. This will read the file from <code>C:\\Users\\jryan\\Documents\\R\\projects\\project-demo\\data\\processed\\data-clean.csv"</code>. The magic of relative paths means that if Dani were have this project on her desktop and run this code, it would read the file from <code>C:\\Users\\dgelardi\\Desktop\\project-demo\\data\\processed\\data-clean.csv</code>. This is why relative paths are so important – they work no matter where the project folder is!</p>
</section>
<section id="here-package" class="level3">
<h3 class="anchored" data-anchor-id="here-package">{here} package</h3>
<p>In combination with R projects, use the <a href="https://here.r-lib.org/">{here}</a> package to build <em>relative</em> file paths. This is especially important in Quarto files because when the <code>.qmd</code> file renders, its default current working directory is wherever the <code>.qmd</code> file lives. If we are using the above example project structure and wanted to read in our clean data to our <code>soil-health-report.qmd</code> file, we would get an error running <code>read.csv("data/processed/data-clean.csv")</code> because it would be looking for a data subfolder in the reports folder. Instead, we can use the {here} package to build a relative path from our root with <code>read.csv(here::here("data", "processed", "data-clean.csv"))</code>. {here} takes care of the backslashes or forward slashes so the relative path will work no matter the operating system.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/57457fc3-1d2d-4a3b-a9b7-f0b62e418cd5_rw_1920.png?h=e0721f766fc8f031edeb67f7f8024595" class="lightbox" title="A cartoon showing two paths side-by-side. On the left is a scary spooky forest, with spiderwebs and gnarled trees, with file paths written on the branches like “~/mmm/nope.csv” and “setwd(”/haha/good/luck/“), with a scared looking cute fuzzy monster running out of it. On the right is a bright, colorful path with flowers, rainbow and sunshine, with signs saying”here!” and “it’s all right here!” A monster facing away from us in a backpack and walking stick is looking toward the right path. Stylized text reads “here: find your path.” Learn more about here. Artwork by @allison_horst." data-gallery="quarto-lightbox-gallery-3"><img src="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/57457fc3-1d2d-4a3b-a9b7-f0b62e418cd5_rw_1920.png?h=e0721f766fc8f031edeb67f7f8024595" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">A cartoon showing two paths side-by-side. On the left is a scary spooky forest, with spiderwebs and gnarled trees, with file paths written on the branches like “~/mmm/nope.csv” and “setwd(”/haha/good/luck/“), with a scared looking cute fuzzy monster running out of it. On the right is a bright, colorful path with flowers, rainbow and sunshine, with signs saying”here!” and “it’s all right here!” A monster facing away from us in a backpack and walking stick is looking toward the right path. Stylized text reads “here: find your path.” Learn more about <a href="https://here.r-lib.org/">here</a>. Artwork by <a href="https://twitter.com/allison_horst">@allison_horst</a>.</figcaption>
</figure>
</div>
</section>
</section>
<section id="naming-conventions" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="naming-conventions"><span class="header-section-number">9.2</span> Naming conventions</h2>
<blockquote class="blockquote">
<p>“There are only two hard things in Computer Science: cache invalidation and naming things.”</p>
<p>— Phil Karlton</p>
</blockquote>
<p>Based on this quote, Indrajeet Patil developed <a href="https://indrajeetpatil.github.io/second-hardest-cs-thing/">slides</a> with a lot of detailed language-agnostic advice on naming things in computer science.</p>
<p>R code specific naming conventions are listed below. They mostly follow the best practices from <a href="naming.html#sec-naming-best-practices"><span>Section&nbsp;3.2</span></a> in the naming conventions chapter, with one exception as described in <a href="#sec-variables-in-a-dataset">variables in a dataset</a>.</p>
<p><strong>TODO</strong>: add Python naming conventions. They differ from R as static variables (aka constants) are supposed to be SCREAMING_SNAKE_CASE.</p>
<section id="project-folder-.rproj-and-github-repository" class="level3">
<h3 class="anchored" data-anchor-id="project-folder-.rproj-and-github-repository">Project folder, .RProj and GitHub repository</h3>
<p>The project folder, .RProj file, and GitHub repository name should be the same. Be concise and descriptive. Use kebab-case.</p>
<p><strong>Example</strong>: <code>washi-dmp</code> and <code>washi-dmp.RProj</code>.</p>
</section>
<section id="files" class="level3">
<h3 class="anchored" data-anchor-id="files">Files</h3>
<p>Be concise and descriptive. Avoid using special characters. Use kebab-case with underscores to separate different metadata groups (date_good-name).</p>
<p><strong>Examples</strong>: <code>2024_producer-report.qmd</code>, <code>tables.R</code>, <code>create-soils.R</code>.</p>
<p>If files should be run in a particular order, prefix them with numbers. Left pad with zero if there may be more than 10 files.</p>
<p><strong>Example</strong>:</p>
<pre><code>01_import.R
02_tidy.R
03_transform.R
04_visualize.R</code></pre>
</section>
<section id="variables-objects-and-functions" class="level3">
<h3 class="anchored" data-anchor-id="variables-objects-and-functions">Variables, objects, and functions</h3>
<p>Let’s first define these terms so we’re on the same page. In this style guide, <strong>variables</strong> are essentially column names, <strong>objects</strong> are all data structures in R and ArcGIS (vectors, lists, data frames, fields, tables), and <strong>functions</strong> are self-contained modules of code that accomplish a specific task.</p>
<section id="sec-variables-in-a-dataset" class="level4">
<h4 class="anchored" data-anchor-id="sec-variables-in-a-dataset">Variables in a dataset</h4>
<p>This is where we differ from the <a href="https://style.tidyverse.org/"><em>tidyverse style guide</em></a>. Hadley recommends using only lowercase letters, numbers, and <code>_</code> for all variables (column names and R objects). However, we are defining variables as only column names. For column names, we use UpperCamelCase and <code>_</code> to separate the measurement name from the unit. Do not use special characters (i.e., write out <code>Percent</code> instead of using <code>%</code>).</p>
<p>This helps us mutate and pivot our data using the <code>_</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>results_long <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"_"</span>), as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"_|pH"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"measurement"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Variable examples:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Clay_Percent</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>96HrMinC_MgCKgDay</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>PMN_MgKg</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses special character</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>Clay_%</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Less human readable, inconsistent with style guide</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>96hrminc_mgkgday</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyphen will need to be escaped in R code to avoid error</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>PMN<span class="sc">-</span>MgKg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-objects-functions" class="level4">
<h4 class="anchored" data-anchor-id="sec-objects-functions">Objects and functions</h4>
<p>Objects names should be nouns, while function names should be verbs <span class="citation" data-cites="wickham2022">(<a href="references.html#ref-wickham2022" role="doc-biblioref">Wickham 2022</a>)</span>. Again, use lowercase letters, numbers, and underscores. Do not put a number as the first character of the name. Do not use hyphens. Do not use names of common functions or variables.</p>
<p><strong>Object examples</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>primary_color</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data_2023</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Less human readable, inconsistent with style guide</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>primarycolor</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a hyphen in an object name causes error</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data<span class="dv">-2023</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"2023_data-clean.csv"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> data <span class="sc">-</span> <span class="dv">2023</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"2023_data-clean.csv"</span>) <span class="sc">:</span> could not find <span class="cf">function</span> <span class="st">"-&lt;-"</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting an object name with a number also causes error</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>2023_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"2023_data-clean.csv"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> unexpected input <span class="cf">in</span> <span class="st">"2023_"</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Overwrites R shortcut for TRUE</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Overwrites R function</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Function examples</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_row</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">assign_quality_codes</span>()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses noun instead of verb</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">row_adder</span>() </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Inconsistent with style guide</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">assignQualityCodes</span>()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Overwrites common base R function</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="r-scripts" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="r-scripts"><span class="header-section-number">9.3</span> R scripts</h2>
<section id="header-template" class="level3">
<h3 class="anchored" data-anchor-id="header-template">Header template</h3>
<p>Including a header in every R script helps standardize the metadata elements provided at the beginning of your code and documents its purpose. Dr.&nbsp;Timothy S Farewell wrote a great <a href="https://timfarewell.co.uk/my-r-script-header-template/">blog post</a> for creating a template for the header of every R script. The following template and instructions are adapted from his post <span class="citation" data-cites="farewell2018">(<a href="references.html#ref-farewell2018" role="doc-biblioref">Farewell 2018</a>)</span>.</p>
<ol type="1">
<li><strong>Script name</strong>: meaningful and concise.</li>
<li><strong>Purpose</strong>: brief description of what the script aims to accomplish.</li>
<li><strong>Author(s) and email</strong>: it’s good to know where the script originated from if there are any questions, comments, or improvements.</li>
<li><strong>Date created</strong>: this is automatically filled in from the template.</li>
<li><strong>Notes</strong>: free-text space for any thoughts or todos.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Header ======================================================================</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Script name: check-crops.R</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Purpose: Cross reference sample requests, Field Maps forms, and management </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## surveys to get the correct crop planted at the time of sampling.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Author: Jadey Ryan </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Email: jryan@agr.wa.gov</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Date created: 2024-01-02</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Notes:</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Attach packages ==============================================================</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ====================================================================</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Add this template to RStudio using <a href="https://docs.posit.co/ide/user/ide/guide/productivity/snippets.html">snippets</a>:</p>
<ol type="1">
<li>Modify the below code with your name and preferred packages.</li>
<li>In RStudio, go to <code>Tools</code> &gt; <code>Edit Code Snippets</code>.</li>
<li>Scroll to the bottom of the R code snippets, and paste your modified code (the indent and tabs are important!).</li>
<li>Click <code>Save</code> and close the window.</li>
<li>Try it out by opening a new blank <code>.R</code> script, typing “header”, and then pressing <code>Shift</code> + <code>Tab</code>.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>snippet header</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Header ======================================================================</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Script name: </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Purpose: </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Author: Jadey Ryan </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Email: jryan@agr.wa.gov</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Date created: `r paste(Sys.Date())`</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Notes:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">##   </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Attach packages ==============================================================</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(readxl)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(writexl)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(janitor)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(tidyr)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load data ====================================================================</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-template" class="level3">
<h3 class="anchored" data-anchor-id="section-template">Section template</h3>
<p>The above header template also uses section breaks (commented lines with <code>=</code> that break up the script into easily readable chunks). Section breaks are fantastic tools in RStudio because they allow you to easily show or hide blocks of code, see an outline of your script, and navigate through the source file. Read more about code folding and sections in this <a href="https://support.posit.co/hc/en-us/articles/200484568-Code-Folding-and-Sections-in-the-RStudio-IDE">Posit article</a>.</p>
<p>The snippet to create this section template that fills in the rest of the line with <code>=</code> was adapted from this <a href="https://stackoverflow.com/questions/32633920/dynamic-rstudio-code-snippet">stack overflow answer</a>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>snippet end</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">r strrep("=", 84 - rstudioapi::primary_selection(rstudioapi::getActiveDocumentContext())$range$start[2])</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After adding the above code to your snippets, try creating a new section by typing “#&nbsp;Tidy&nbsp;data&nbsp;end” then pressing <code>Shift</code> + <code>Tab</code>.</p>
<p><code># Tidy data end&lt;Shift+Tab&gt;</code> results in:</p>
<pre><code># Tidy data ====================================================================</code></pre>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="images/sections.png" class="lightbox" title="Screenshot of RStudio with boxes highlighting section functionality including collapsed code blocks, Jump To menu, and the document outline." data-gallery="quarto-lightbox-gallery-4"><img src="images/sections.png" class="img-fluid figure-img" alt="Screenshot of RStudio with boxes highlighting section functionality including collapsed code blocks, Jump To menu, and the document outline."></a></p>
</figure>
</div>
</section>
</section>
<section id="code-styling" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="code-styling"><span class="header-section-number">9.4</span> Code styling</h2>
<p>Review the Syntax chapter of the <a href="https://style.tidyverse.org/syntax.html"><em>tidyverse style guide</em></a> for a lengthy section that covers spacing, function calls, long lines, semicolons, assignments, comments, etc. Also skim through <a href="https://r4ds.hadley.nz/workflow-style.html">Chapter 4 Workflow: code style in <em>R4DS</em></a>, which highlights the opinionated “most important parts of the tidyverse style guide”. Instead of rewriting all of these details and conventions into this style guide and making us all memorize the content, we should all just use the <a href="https://styler.r-lib.org/">{styler}</a> R Package (as advised in <em>R4DS</em> Chapter 4).</p>
<p>{styler} is a package and RStudio Addin that formats code for you, so we can keep our coding style consistent across projects and better facilitate collaboration. We’ll deviate slightly from the tidyverse style and instead use <a href="https://github.com/gadenbuie/grkstyle">{grkstyle}</a>. {grkstyle} is an extension package for {styler} that Garrick Aden-Buie developed based on the tidyverse style guide. I prefer {grkstyle} over the tidyverse style that {styler} defaults to mainly because of how it handles line breaks in function calls.</p>
<p>The below example and installation instructions are pretty much copied directly from Garrick’s {grkstyle} README.</p>
<section id="examples" class="level3">
<h3 class="anchored" data-anchor-id="examples">Examples</h3>
<section id="grkstyle" class="level4">
<h4 class="anchored" data-anchor-id="grkstyle">grkstyle</h4>
<pre><code>do_something_very_complicated(
    something = "that",
    requires = many,
    arguments = "some of which may be long"
) </code></pre>
</section>
<section id="stylertidyverse_style" class="level4">
<h4 class="anchored" data-anchor-id="stylertidyverse_style">styler::tidyverse_style</h4>
<pre><code>do_something_very_complicated(
  something = "that", requires = many,
  arguments = "some of which may be long"
) </code></pre>
</section>
</section>
<section id="installation" class="level3">
<h3 class="anchored" data-anchor-id="installation">Installation</h3>
<p>Install {styler} and {grkstyle} with:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"styler"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gadenbuie =</span> <span class="st">"https://gadenbuie.r-universe.dev"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getOption</span>(<span class="st">"repos"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and install grkstyle in R</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"grkstyle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Set <code>grkstyle</code> as the default in {styler} functions and addins by running</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default code style for {styler} functions</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>grkstyle<span class="sc">::</span><span class="fu">use_grk_style</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or adding the following to your <code>~/.Rprofile</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">styler.addins_style_transformer =</span> <span class="st">"grkstyle::grk_style_transformer()"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To edit your <code>.Rprofile</code>, you can use <code>usethis::edit_r_profile()</code> to open the file in your RStudio. You may need to install the <a href="https://usethis.r-lib.org/">{usethis}</a> package.</p>
</section>
<section id="usage" class="level3">
<h3 class="anchored" data-anchor-id="usage">Usage</h3>
<p>Once {styler} and {grkstyle} are installed, you can apply the style to your <code>.R</code>, <code>.qmd</code>, and <code>.Rmd</code> files using the command palette, keyboard shortcut, or addins menu.</p>
<section id="command-palette" class="level4">
<h4 class="anchored" data-anchor-id="command-palette">Command palette</h4>
<p>Use RStudio’s <strong>command palette</strong> to quickly and easily access any RStudio command and see keyboard shortcuts. Open the command palette with <code>Cmd/Ctrl + Shift + P</code>, then type “styler” to see the shortcuts offered by {styler}.</p>
</section>
<section id="keyboard-shortcuts" class="level4">
<h4 class="anchored" data-anchor-id="keyboard-shortcuts">Keyboard shortcuts</h4>
<p>I often use <code>Cmd/Ctrl + Shift + A</code> to style the entire active file every time I finish a code block or section. To style just a selection, use <code>Cmd/Ctrl + Alt + Shift + A</code>.</p>
</section>
<section id="addins-menu" class="level4">
<h4 class="anchored" data-anchor-id="addins-menu">Addins menu</h4>
<p>You can also use the Addins menu in RStudio to style your files by clicking on a button to run the command.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="images/styler.png" class="lightbox" title="Screenshot of RStudio with the Addins menu open and boxes highlighting the styler functions." data-gallery="quarto-lightbox-gallery-5"><img src="images/styler.png" class="img-fluid figure-img" alt="Screenshot of RStudio with the Addins menu open and boxes highlighting the styler functions."></a></p>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-farewell2018" class="csl-entry" role="listitem">
Farewell, Dr Timothy S. 2018. <span>“My Easy r Script Header Template <span></span> Tim Farewell.”</span> <a href="https://timfarewell.co.uk/my-r-script-header-template/">https://timfarewell.co.uk/my-r-script-header-template/</a>.
</div>
<div id="ref-wickham2022" class="csl-entry" role="listitem">
Wickham, Hadley. 2022. <em>The Tidyverse Style Guide</em>. <a href="https://style.tidyverse.org/index.html">https://style.tidyverse.org/index.html</a>.
</div>
</div>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Note the two backslashes. Windows paths use backslashes, which mean something specific in R. to get a single backslash in the path, we need to type two backslashes (or use forward slashes).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./share.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data sharing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","selector":".lightbox","loop":false,"descPosition":"right"});</script>



</body></html>